import{d as Z,u as tt,r as H,s as et,b,e as O,o as a,c as u,a as e,f as j,w as P,g as v,h,t as c,i as p,v as w,F as E,j as R,n as st,k as U,l as n}from"./index.09b2e381.js";import{u as ot,h as it,s as nt,A as rt,O as at}from"./IdorStore.cbd4ca2d.js";import{_ as lt}from"./plugin-vue_export-helper.21dcd24c.js";const dt=Z({props:{},setup(t){const o=ot(),N=tt(),L=H(1),T=H(!1),{length:f,max_length:y,nr_requests:k,notify_victim:d,online:s,alphabet:l,start_value_str:x,correct_guesses:C,target_certainty:I,threat_multiplier:_,lockout:M}=et(o);if(console.log("value: "+l.value),console.log(N.query),N.query?.c?.toString()?.length){const i=JSON.parse(atob(N.query?.c.toString()));f.value=Number(i.l)||f.value,y.value=Number(i.ml)||y.value,k.value=Number(i.r)||k.value,d.value=Boolean(i.n)||d.value,s.value=Boolean(i.o)||s.value,l.value=i.a?.toString()||l.value,x.value=i.s?.toString()||x.value,C.value=BigInt(i?.c?.toString()||1n)||C.value,I.value=Number(i.tc)||I.value,_.value=Number(i.tm)||_.value,M.value=Boolean(i.lo)||M.value}const $=b(()=>btoa(JSON.stringify({l:f.value,ml:y.value,r:k.value,n:d.value,o:s.value,a:l.value,s:x.value,c:C.value.toString(),tc:I.value,tm:_.value,lo:M.value}))),V=b(()=>F(x.value)),J=b(()=>s.value?d.value?1e3*60*60*_.value:1e3*60*60*24*_.value:d.value?1e3*60*60*_.value:1e3*60*60*24*30*12*_.value),D=b(()=>k.value/1e3),G={numbers:"0123456789",hexadecimal:"0123456789abcdef",alphabet:"abcdefghijklmnopqrstuvwxyz",alphanumeric:"0123456789abcdefghijklmnopqrstuvwxyz",base64:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/","base64 (urlsafe)":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"},K=i=>{if(i===void 0)return;const r=V.value;l.value=i,x.value=z(r)},W=i=>(console.log(i),[...new Set(i)].join("")),S=b(()=>(console.log("xxxx"),console.log(l.value),console.log(f.value),console.log(V.value),console.log("xxxx"),BigInt(l.value.length)**BigInt(f.value)-V.value)),z=i=>{var r=i,m=r==0n?l.value[0]:"";const g=BigInt(l.value.length);for(;r!=0n;){var A=r%g;m=l.value[Number(A)]+m,r=(r-A)/g}return m},F=i=>{var r={},m=0n,g=1n;const A=BigInt(l.value.length);for(var q=i.length-1;q>=0;q--){var B=i[q];r[B]==null&&(r[B]=BigInt(l.value.indexOf(B))),m+=g*r[B],g*=A}return m};function Y(i){for(var r=[],m=i.toString().length/9+2|0;m--;)r.push((""+(Math.random()*1e9|0)).padStart(9,"0"));return BigInt(r.join(""))%i}b(()=>(console.log(D.value),console.log(S.value),D.value/Number(S.value)*1e3));const Q=b(()=>{const i=Number(C.value)/Number(S.value),r=I.value,m=Math.log(1-r)/Math.log(1-i);return isFinite(m)?m:1/0}),X=b(()=>{const i=Number(C.value),r=Number(S.value),m=Number(I.value),g=1/(i/r/m);return console.log(g),isFinite(g)?g:1/0});return{length:f,alphabet:l,setAlphabet:K,alphabet_preset:G,maxNumber:S,nr_requests:k,uniqueChars:W,start_value_str:x,randBigInt2:Y,start_value:V,requestsPerMs:D,target_certainty:I,correct_guesses:C,dec2base:z,base2dec:F,binominal_distribution:Q,notify_victim:d,hypergeometric_distribution:X,humanizeDuration:it,online:s,max_length:y,tailwindcss:{theme:{colors:{transparent:"transparent",current:"currentColor",black:"#131A21",blacker:"#000000",white:"#ffffff",red:"#DD4B21",green:"#16c1a2",yellow:"#D8AD66",purple:"#681FC4",blue:"#0EC7F0",orange:"#FF8A00",pink:"#DC2CEC",light:"#f5f5f9",dark:"#1f2129",darker:"#151519"}}},threshold:J,threat_multiplier:_,lockout:M,showSettings:T,showTab:L,directLink:$}},components:{slider:nt,AttackerItem:rt,OverlayBlock:at}}),ct={class:"text-white p-5 w-full"},mt=e("h1",{class:"text-xl font-bold"},[e("span",{class:"text-green font-bold"},"IDOR"),n(" Vulnerability Calculator ")],-1),ut={class:"text-white float-right flex flex-row gap-2"},ht=e("i",{class:"fa-solid fa-gear"},null,-1),pt=[ht],gt=e("i",{class:"fas fa-share ml-1"},null,-1),_t=e("p",{class:"lg:w-2/3 mt-5"},[n(" Use the calculator to test how resistant various random identifiers are against bruteforce attacks. "),e("br"),n(" This is applicable to "),e("span",{class:"text-green font-bold",label:"Insecure Direct Object Reference"},"IDOR"),n(" vulnerabilities, 2FA tokens, session tokens or generally any random value. ")],-1),bt=e("b",null,[e("i",{class:"fa-solid fa-gear text-white text-opacity-50 mr-3"}),n(" Advanced Settings")],-1),vt={class:"grid grid-cols-2 content-center mt-5"},ft=e("div",{class:"text-sm font-medium sm:mt-px sm:pt-2 pr-10"}," Slider Max ID Length ",-1),yt={class:"text-sm font-medium sm:mt-px sm:pt-2 pr-10"},kt=n(" Certainty ("),wt={class:"text-green font-bold"},xt=n(") "),Ct={class:"flex items-center sm:pt-2"},It={class:"flex flex-row whitespace-nowrap"},St=e("span",{class:"font-bold"},"1%",-1),Nt=e("span",{class:"font-bold"},"100%",-1),Mt=e("div",{class:"text-sm font-medium sm:mt-px sm:pt-2 pr-10"}," Start Value ",-1),Vt={class:"sm:pt-2"},At={class:"mt-6 sm:mt-5 space-y-6 sm:space-y-5"},Bt={class:"sm:grid sm:grid-cols-3 sm:gap-4 sm:items-start sm:border-dark sm:pt-5"},Dt={for:"username",class:"block text-sm font-medium sm:mt-px sm:pt-2"},qt=n(" ID of length "),Ot={class:"text-green font-bold"},Pt={class:"mt-1 sm:mt-0 sm:col-span-2"},Ut={class:"my-2 text-sm text-gray-500"},Lt=n(" How long is the identifier or random value? "),Tt={class:"text-green font-bold text-base ml-1"},zt={class:"flex flex-row whitespace-nowrap"},Ft=e("span",{class:"font-bold"},"2",-1),Ht=["max"],jt={class:"font-bold"},Et={class:"sm:grid sm:grid-cols-3 sm:gap-4 sm:items-start sm:border-t sm:border-dark sm:pt-5"},Rt={for:"about",class:"block text-sm font-medium sm:mt-px sm:pt-2"},$t=n(" Alphabet with "),Jt={class:"text-green font-bold"},Gt=n(" characters "),Kt={class:"mt-1 sm:mt-0 sm:col-span-2"},Wt=e("p",{class:"my-2 text-sm text-gray-500"}," List of characters used for the identifier. You can also select a preset: ",-1),Yt=["onClick"],Qt={class:"sm:grid sm:grid-cols-5 sm:gap-4 sm:items-start sm:border-t sm:border-dark sm:pt-5"},Xt={class:"bg-dark sm:col-span-5 md:col-start-2 md:col-end-5 rounded rounded-lg p-5"},Zt=n(" There are "),te={class:"text-green font-bold"},ee=n(" possible IDs. "),se={class:"my-2"},oe=n(" Here are some example ID values: "),ie={class:"my-2 flex flex-wrap max-h-12 overflow-hidden"},ne={class:"sm:grid sm:grid-cols-3 sm:gap-4 sm:items-start sm:border-t sm:border-dark sm:pt-5"},re=e("label",{for:"username",class:"block text-sm font-medium sm:mt-px sm:pt-2"}," Correct Guesses ",-1),ae={class:"mt-1 sm:mt-0 sm:col-span-2"},le={class:"mt-2 text-sm text-gray-500"},de=n(" Select how many of the "),ce={class:"text-green font-bold"},me=n(" possibilities actually exist and could be found. "),ue={class:"sm:grid sm:grid-cols-3 sm:gap-4 sm:items-start sm:border-t sm:border-dark sm:pt-5"},he={for:"username",class:"block text-sm font-medium sm:mt-px sm:pt-2"},pe=n(" Threat Multiplier: "),ge={key:0,class:"text-green font-bold"},_e={key:1,class:"text-yellow font-bold"},be={key:2,class:"text-red font-bold"},ve={class:"mt-1 sm:mt-0 sm:col-span-2"},fe={class:"flex flex-row whitespace-nowrap"},ye=e("span",{class:"text-green font-bold"},"Not Critical",-1),ke=e("span",{class:"text-red font-bold"},"Very Critical",-1),we={class:"mt-2 text-sm text-gray-500"},xe=n(" How critical is the data you try to access? This affects how long it should take an attacker to succeed ("),Ce={class:"text-green font-bold"},Ie=n(") "),Se={class:"sm:grid sm:grid-cols-3 sm:gap-4 sm:items-start sm:border-t sm:border-dark sm:pt-5"},Ne=e("label",{for:"username",class:"block text-sm font-medium sm:mt-px sm:pt-2"}," Additional Context ",-1),Me={class:"mt-1 sm:mt-0 sm:col-span-2"},Ve={class:"max-w-lg space-y-4"},Ae={class:"relative flex items-start"},Be={class:"flex items-center h-5"},De=e("div",{class:"ml-3 text-sm"},[e("label",{for:"comments",class:"font-medium"},"Victim Notification"),e("p",{class:"text-gray-500"}," Does attacking alert the victim? eg. trigger mail, SMS, ... ")],-1),qe={class:"relative flex items-start"},Oe={class:"flex items-center h-5"},Pe=e("div",{class:"ml-3 text-sm"},[e("label",{for:"candidates",class:"font-medium"},"Online Attack"),e("p",{class:"text-gray-500"}," Is this attack done over the internet or locally? ")],-1),Ue={class:"relative flex items-start"},Le={class:"flex items-center h-5"},Te=e("div",{class:"ml-3 text-sm"},[e("label",{for:"offers",class:"font-medium"},"Hard Lockout"),e("p",{class:"text-gray-500"}," System completely locked after some attempts? ")],-1),ze={class:"grid sm:grid-cols-2 md:grid-cols-3 lg:sm:grid-cols-4 gap-4 sm:items-start sm:border-t sm:border-dark sm:pt-5"},Fe={class:"text-lg font-bold"},He=n(" Results "),je={class:"text-sm font-normal text-xs ml-2"},Ee=n(" share direct link "),Re=e("i",{class:"fas fa-share ml-1"},null,-1),$e={class:"sm:grid sm:grid-cols-5 sm:gap-4 sm:items-start"},Je={class:"bg-dark sm:col-span-5 md:col-start-2 md:col-end-5 rounded rounded-lg p-5"},Ge=n(" To find one succesfully with "),Ke=n(" certainty ... "),We={class:"ml-4"},Ye=n(" ... you need "),Qe={class:"text-green font-bold"},Xe=n(" if every attempt is random. "),Ze={key:0},ts=n(" ... you need "),es={class:"text-green font-bold"},ss=n(" if you search in a set. "),os={key:0},is={class:"mt-2"},ns=n(` With the current threat settings it's considered "bad" when you succeed in under `),rs={class:"text-green font-bold"},as=n(". "),ls=e("div",{class:"grid sm:grid-cols-2 md:grid-cols-3 lg:sm:grid-cols-4 gap-4 sm:items-start sm:pt-5"},[e("h1",{class:"text-md font-bold"},"Simulated Attackers")],-1),ds={class:"grid sm:grid-cols-2 md:grid-cols-3 lg:sm:grid-cols-4 gap-4 sm:pt-5"};function cs(t,o,N,L,T,f){const y=O("router-link"),k=O("OverlayBlock"),d=O("AttackerItem");return a(),u("div",ct,[mt,e("div",ut,[e("span",{class:"text-white cursor-pointer text-opacity-50 hover:text-white hover:text-opacity-100",onClick:o[0]||(o[0]=s=>t.showSettings=!0)},pt),j(y,{to:{name:"idor-calculator",query:{c:t.directLink}},class:"text-white cursor-pointer text-opacity-50 hover:text-white hover:text-opacity-100"},{default:P(()=>[gt]),_:1},8,["to"])]),_t,t.showSettings?(a(),v(k,{key:0,onClickClose:o[4]||(o[4]=()=>t.showSettings=!1)},{default:P(()=>[bt,e("div",vt,[ft,e("div",null,[p(e("input",{type:"number",class:"bg-darker w-full text-right rounded-md px-2 py-1","onUpdate:modelValue":o[1]||(o[1]=s=>t.max_length=s)},null,512),[[w,t.max_length]])]),e("div",yt,[kt,e("span",wt,c(Math.ceil(t.target_certainty*100))+"%",1),xt]),e("div",Ct,[e("div",It,[St,p(e("input",{type:"range",class:"mx-2 accent-green w-full transition-all",min:"0.01",step:"0.01",max:"1.00","onUpdate:modelValue":o[2]||(o[2]=s=>t.target_certainty=s)},null,512),[[w,t.target_certainty,void 0,{number:!0}]]),Nt])]),Mt,e("div",Vt,[p(e("input",{type:"number",class:"bg-darker w-full text-right rounded-md px-2 py-1","onUpdate:modelValue":o[3]||(o[3]=s=>t.start_value_str=s)},null,512),[[w,t.start_value_str]])])])]),_:1})):h("",!0),e("div",null,[e("div",At,[e("div",Bt,[e("label",Dt,[qt,e("span",Ot,c(t.length),1)]),e("div",Pt,[e("p",Ut,[Lt,e("span",Tt,c(t.length),1)]),e("div",zt,[Ft,p(e("input",{type:"range",class:"mx-2 accent-green w-full md:w-1/2 transition-all",min:"2",step:"1",max:t.max_length,"onUpdate:modelValue":o[5]||(o[5]=s=>t.length=s)},null,8,Ht),[[w,t.length]]),e("span",jt,c(t.max_length),1)])])]),e("div",Et,[e("label",Rt,[$t,e("span",Jt,c(t.alphabet.length),1),Gt]),e("div",Kt,[Wt,p(e("input",{class:"bg-darker px-1 mb-1 w-full font-mono text-white text-opacity-50 focus:text-opacity-100",type:"text","onUpdate:modelValue":o[6]||(o[6]=s=>t.alphabet=s),ref:"alphabet_input",onInput:o[7]||(o[7]=()=>{t.alphabet=t.uniqueChars(t.alphabet)})},null,544),[[w,t.alphabet]]),e("div",null,[(a(!0),u(E,null,R(Object.keys(t.alphabet_preset),s=>(a(),u("button",{class:"px-3 py-1 rounded rouned-lg m-1 border-2 hover:border-white bg-dark border-dark",onClick:l=>t.setAlphabet(t.alphabet_preset[s])},c(s),9,Yt))),256)),e("button",{class:"px-3 py-1 rounded rouned-lg m-1 border-2 hover:border-white bg-dark border-dark text-opacity-50",onClick:o[8]||(o[8]=s=>t.$refs.alphabet_input.focus())}," custom ")])])]),e("div",Qt,[e("div",Xt,[e("div",null,[Zt,e("span",te,c(t.maxNumber),1),ee]),e("div",se,[oe,e("div",ie,[(a(!0),u(E,null,R(new Array(Math.ceil(200/t.length)),(s,l)=>(a(),u("div",{key:l,class:"font-mono mr-2 text-white text-opacity-50"},c(t.dec2base(t.start_value+t.randBigInt2(t.maxNumber-t.start_value)).padStart(t.length,t.alphabet[0])),1))),128))])])])]),e("div",ne,[re,e("div",ae,[p(e("input",{class:"bg-dark w-36 text-right rounded-md px-2 py-1",type:"number","onUpdate:modelValue":o[9]||(o[9]=s=>t.correct_guesses=s)},null,512),[[w,t.correct_guesses,void 0,{bigint:!0}]]),e("p",le,[de,e("span",ce,c(t.maxNumber),1),me])])]),e("div",ue,[e("label",he,[pe,t.threat_multiplier<2?(a(),u("span",ge,"Not Critical")):t.threat_multiplier<5?(a(),u("span",_e,"Somewhat Critical")):(a(),u("span",be,"Very Critical"))]),e("div",ve,[e("div",fe,[ye,p(e("input",{type:"range",class:st(["mx-2 accent-green w-full md:w-1/2 transition-all",{"accent-green":t.threat_multiplier<2,"accent-yellow":t.threat_multiplier>=2&&t.threat_multiplier<7,"accent-red":t.threat_multiplier>=7}]),min:"0.001",step:"0.005",max:"10","onUpdate:modelValue":o[10]||(o[10]=s=>t.threat_multiplier=s)},null,2),[[w,t.threat_multiplier]]),ke]),e("p",we,[xe,e("span",Ce,c(t.humanizeDuration(t.threshold,{largest:1,round:!0})),1),Ie])])]),e("div",Se,[Ne,e("div",Me,[e("div",Ve,[e("div",Ae,[e("div",Be,[p(e("input",{id:"comments","onUpdate:modelValue":o[11]||(o[11]=s=>t.notify_victim=s),name:"comments",type:"checkbox",class:"focus:ring-green accent-green text-dark h-4 w-4 text-green border-dark rounded"},null,512),[[U,t.notify_victim]])]),De]),e("div",null,[e("div",qe,[e("div",Oe,[p(e("input",{id:"candidates",name:"candidates","onUpdate:modelValue":o[12]||(o[12]=s=>t.online=s),type:"checkbox",class:"focus:ring-green accent-green text-dark h-4 w-4 text-green border-dark rounded"},null,512),[[U,t.online]])]),Pe])]),e("div",null,[e("div",Ue,[e("div",Le,[p(e("input",{id:"offers",name:"offers",type:"checkbox","onUpdate:modelValue":o[13]||(o[13]=s=>t.lockout=s),class:"focus:ring-green accent-green text-dark h-4 w-4 text-green border-dark rounded"},null,512),[[U,t.lockout]])]),Te])])])])]),e("div",ze,[e("h1",Fe,[He,e("span",je,[j(y,{to:{name:"idor-calculator",query:{c:t.directLink}},class:"text-white cursor-pointer text-opacity-50 hover:text-white hover:text-opacity-100"},{default:P(()=>[Ee,Re]),_:1},8,["to"])])])]),e("div",$e,[e("div",Je,[e("div",null,[Ge,e("i",null,c(Math.floor(t.target_certainty*100))+"%",1),Ke]),e("div",We,[e("div",null,[Ye,e("span",Qe,c(t.binominal_distribution!==1/0?Math.ceil(t.binominal_distribution):"\u221E")+" attempts",1),Xe,t.hypergeometric_distribution>307584e10?(a(),u("span",Ze," It's impossible! ")):h("",!0)]),e("div",null,[ts,e("span",es,c(t.hypergeometric_distribution!==1/0?Math.ceil(t.hypergeometric_distribution):"\u221E")+" attempts",1),ss,t.hypergeometric_distribution>307584e10?(a(),u("span",os," It's impossible! ")):h("",!0)])]),e("div",is,[ns,e("span",rs,c(t.humanizeDuration(t.threshold,{largest:1,round:!0})),1),as])])]),ls,e("div",ds,[t.online?(a(),v(d,{key:0,binominal_distribution:t.binominal_distribution,target_certainty:t.target_certainty,hypergeometric_distribution:t.hypergeometric_distribution,threshold:t.threshold,requestsPerMs:5/1e3,notify_victim:t.notify_victim,lockout:t.lockout,name:"Lazy Hacker",description:"A simple python script"},null,8,["binominal_distribution","target_certainty","hypergeometric_distribution","threshold","notify_victim","lockout"])):h("",!0),t.online?(a(),v(d,{key:1,binominal_distribution:t.binominal_distribution,target_certainty:t.target_certainty,hypergeometric_distribution:t.hypergeometric_distribution,threshold:t.threshold,notify_victim:t.notify_victim,lockout:t.lockout,requestsPerMs:200/1e3,name:"Script Kiddie",description:"Hacker with an optimized script over the internet"},null,8,["binominal_distribution","target_certainty","hypergeometric_distribution","threshold","notify_victim","lockout"])):h("",!0),t.online?(a(),v(d,{key:2,binominal_distribution:t.binominal_distribution,target_certainty:t.target_certainty,hypergeometric_distribution:t.hypergeometric_distribution,threshold:t.threshold,notify_victim:t.notify_victim,lockout:t.lockout,requestsPerMs:1e3/1e3,name:"Prepared Attacker",description:"Hacker renting server in close proximity (same region or data center)"},null,8,["binominal_distribution","target_certainty","hypergeometric_distribution","threshold","notify_victim","lockout"])):h("",!0),t.online?(a(),v(d,{key:3,binominal_distribution:t.binominal_distribution,target_certainty:t.target_certainty,hypergeometric_distribution:t.hypergeometric_distribution,threshold:t.threshold,notify_victim:t.notify_victim,lockout:t.lockout,requestsPerMs:1e5/1e3,name:"Performance Nerd",description:"Owning IP ranges and lots of servers"},null,8,["binominal_distribution","target_certainty","hypergeometric_distribution","threshold","notify_victim","lockout"])):h("",!0),t.online?h("",!0):(a(),v(d,{key:4,binominal_distribution:t.binominal_distribution,target_certainty:t.target_certainty,hypergeometric_distribution:t.hypergeometric_distribution,threshold:t.threshold,notify_victim:t.notify_victim,lockout:t.lockout,requestsPerMs:1/1e4,name:"Opportunistic Thief",description:"A thief who performs some attempts by hand"},null,8,["binominal_distribution","target_certainty","hypergeometric_distribution","threshold","notify_victim","lockout"])),t.online?h("",!0):(a(),v(d,{key:5,binominal_distribution:t.binominal_distribution,target_certainty:t.target_certainty,hypergeometric_distribution:t.hypergeometric_distribution,threshold:t.threshold,notify_victim:t.notify_victim,lockout:t.lockout,requestsPerMs:2/1e3,name:"Automation",description:"Device that automatically tests inputs"},null,8,["binominal_distribution","target_certainty","hypergeometric_distribution","threshold","notify_victim","lockout"])),t.online?h("",!0):(a(),v(d,{key:6,binominal_distribution:t.binominal_distribution,target_certainty:t.target_certainty,hypergeometric_distribution:t.hypergeometric_distribution,threshold:t.threshold,notify_victim:t.notify_victim,lockout:t.lockout,requestsPerMs:1e4/1e3,name:"Hardware Hacker",description:"Specialized tooling and parallelism"},null,8,["binominal_distribution","target_certainty","hypergeometric_distribution","threshold","notify_victim","lockout"]))])])])])}var gs=lt(dt,[["render",cs]]);export{gs as default};
